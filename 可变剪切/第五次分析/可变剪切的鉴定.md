可变剪切的鉴定

为了方便在不同的基因组之间进行比较，AS的鉴定还是选择那些比较PacBio转录本之间的AS；从11_AS/end_splice.txt`文件中提取两个转录本都是PB注释的AS。将冗余的内含子保留信息合并一下

> 公司在鉴定AS的时候，把PB和参考基因组的转录本进行了合并；用参考基因组中原有的注释代替了PacBio的注释；而A2中只有一个转录本的注释。所以当我去取两个都是PB的转录本的时候，A2的就会比较多。
>
> 重新鉴定AS，使用gmap将PacBio比对到参考基因组输出格式设置为cDNA格式的gff文件
>
> 在使用AS的脚本去鉴定AS

+ test.gff 文件为Gmap的输出结果
+ PacBio.gff为PacBio转录本的注释信息
+ as  统计剪切位点处的编码
+ ats  输出AS鉴定的统计信息
+ os 输出剪切处的fasta序列
+ op 输出SVG图片信息

```bash
##先使用GMap进行比对
##再比对PacBio转录本之间的信息，使用脚本
/usr/bin/python ~/software/pipeline-for-isoseq/other/alternative_splice.py -i ./test.gff -g ./PacBio.gtf  -f ~/work/Alternative/data/Ghirsutum_genome_HAU_v1.0/Ghirsutum_genome_HAU_v1.0.fasta -as -ats T -os  -t exon   -op -o /public/home/zpliu/work/Alternative/result/Gh_result/CO31_32_result/11_AS/alter_splice
##使用脚本对根据剪切编码进行分类
python ~/scripte/Alternative/classSplice.py
##根据去除冗余后的isoform提取其中的AS
python adjustAS.py -isoformId /public/home/zpliu/work/Alternative/result/homologo/FEST5/isoform/cdHit/A2_merge_isoform  -AS alter_splice2/111  -o test
```

```bash
###去除冗余
python ~/work/Alternative/result/homologo/FEST4/conserveAS/allAS/arrangeAS.py  -h
##统计数目
```

#### 使用AS脚本鉴定AS

只鉴定PacBio转录本之间的IR，首先需要将`../07_annotation/TM-1_merge_C.gtf`文件中只提取PacBio的注释信息

```bash
##提取有基因注释的PacBio转录本信息，里面包含了lncRNA
grep "PB" ../07_annotation/TM-1_merge_C.gtf >PacBio.gtf
## 运行鉴定可变剪切的脚本
```

统计各个棉种中的数量信息，在没去冗余之前

| 基因组 | IR    | ES   | AltA | AltD | AltP | Other |
| ------ | ----- | ---- | ---- | ---- | ---- | ----- |
| TM1    | 36172 | 2503 | 8033 | 6422 | 5876 | 4041  |
| D5     | 22540 | 1323 | 4669 | 3617 | 3648 | 2465  |
| A2     | 32179 | 2386 | 7186 | 5646 | 5553 | 3995  |

去完冗余转录本后，AS的统计
| 基因组 | IR    | ES   | AltA | AltD | AltP | Other |
| ------ | ----- | ---- | ---- | ---- | ---- | ----- |
| TM1    | 33225 | 2208 | 6144 | 4848 | 3796 | 2549  |
| D5     | 20680 | 1171 | 3497 | 2628 | 2343 | 1513  |
| A2     | 29488 | 2120 | 5411 | 4256 | 3570 | 2448  |



使用`lr2rmats`鉴定可变剪切

