### 保守转录本与不保守转录本的差异

1.保守转录本与不保守转录本在亚基因组间的占比

> 多倍化过程中有54.1%~60.7%的转录本是特异性的转录本，并且在二倍体中有更高比例的特异性转录本存在。

| 基因组 | 保守转录本   | 特异性转录本 | 总的转录本 |
| ------ | ------------ | ------------ | ---------- |
| A2     | 17915(39.3%) | 27629(60.7%) | 45544      |
| At     | 13386(41.8%) | 18612(58.2%) | 31998      |
| Dt     | 15357(45.9%) | 18106(54.1%) | 33463      |
| D5     | 17151(44.0%) | 21821(56%)   | 38,972     |

**2.转录出特异性转录本的基因数，在多倍化过程中逐渐减少**，多倍化后更少的基因转录出多个特异性的转录本

在A2中一共有8557个基因存在特异性的转录本，At中一共有7630个基因存在特异性的转录本，D5中一共有8103的基因存在特异性的转录本，Dt中一共有7420个基因存在特异性的转录本。

> 在二倍体中更多的基因转录出多个特异性的转录本

```bash
cut -f1 Dt_specialIsoformAnnotion.txt |sort |uniq -c|awk '{print $1}'|sort |uniq -c|awk '$2>=10{a+=$1}$2<10{print "Dt\t"$2"\t"$1}END{print "Dt\t>10\t"a}'
```

**3.特异性转录本与保守转录本在CDS长度和FPKM上的比较**

**低表达的转录本：FPKM值<1，卡方测验**

> 不同类型的转录本与转录本的表达水平是否存在差异

| 类型           | 低表达 | 高表达 |
| -------------- | ------ | ------ |
| 特异性的转录本 | 10424  | 8188   |
| 保守的转录本   | 5163   | 8223   |

```R
##进行卡方测验
data=matrix(c(10424,5163,8188,8223),nrow=2)
chisq.test(data)
#或者fisher.test(data)
```

**4.特异性转录本中不同AS类型的数目**

在同一个基因中将特异性的转录本与保守的转录本进行比较，发现差异的AS在其中的比例，

**并且这种差异的AS被认为是亚组特异性的AS**

| 基因组 | 保守的转录本 | 特异的转录本 | 特异转录本与保守转录本间存在AS 差异 | 其他原因导致的特异性转录本 |
| ------ | ------------ | ------------ | ----------------------------------- | -------------------------- |
| A2     | 17915        | 27629        | 17566                               | 10063                      |
| At     | 13386        | 18612        | 12831                               | 5781                       |
| D5     | 17151        | 21821        | 15032                               | 6789                       |
| Dt     | 15357        | 18106        | 12530                               | 5576                       |

这些AS事件的种类和数目的统计

```bash
##剪切事件数目的统计
cut -f3 A2_specialIsoformAnnotion.txt |sed 's/,/\n/g'|sort |uniq 
##存在AS事件差异数目，和特异性转录本数目之间的相关性
python ../../D5_vs_DT/conserve_vs_specialIsoform/special_AS.py A2_specialIsoformAnnotion.txt  11
```

**同时基因产生特异性转录本的数目与AS的数目存在正相关**

| 基因组 | IR   | ES   | A5   | A3   | total |
| ------ | ---- | ---- | ---- | ---- | ----- |
| A2     | 7231 | 1132 | 2788 | 4139 | 15290 |
| At     | 5953 | 1133 | 3120 | 4044 | 14251 |
| D5     | 6805 | 1452 | 3186 | 5046 | 16489 |
| Dt     | 5979 | 1076 | 3003 | 3905 | 13963 |



**5.A、D亚组间特异性转录本的丢失与获得**

A2 vs At 11292

D5 vs Dt 11690

> 不同的基因组对于特异性转录本的比例是否存在相关性，在多倍化过程中A基因组更多的基因发生了特异性转录本的丢失；而在四倍体中同样的是At中更多基因获得了特异的转录本。

卡方测验：特异性转录本的丢失

| 基因组 | 存在特异性转录本的基因 | 不存在特异性转录本的基因 |
| ------ | :--------------------- | ------------------------ |
| A2     | 8557(75.77%)           | 2735                     |
| D5     | 8103(69.3%)            | 3587                     |
| At     | 7630(67.5%)            | 3662                     |
| Dt     | 7420(63.5%)            | 4270                     |

###### 6.基因主要表达的转录本是否发生改变

在多倍化过程中存在特异性转录本和保守转录本的基因中，基因所表达的主要转录本是否发生了改变。

```bash
##提取既存在保守转录本又存在特异性转录本的基因对
awk -F "\t" '$4!=""{print $0}' A2_allConserve_At_special.txt |cut -f1-4  >Isoform_DomainFPKMChange/conserve_specialIsoform.txt 
awk -F "\t" '$2!=""{print $0}' A2_special_At_allConserve.txt |cut -f1,2,4,5 >>Isoform_DomainFPKMChange/conserve_specialIsoform.txt 
awk -F "\t"  '$5!=""&&$2!=""{print $0}' gene_conserve_allSpecial.txt |cut -f1,2,4,5 >>Isoform_DomainFPKMChange/conserve_specialIsoform.txt 
##这些基因的主要表达的转录本是否仍旧保守
python /public/home/zpliu/work/Alternative/result/Gh_result/CO31_32_result/evolution4/A2_vs_AT/conserve_vs_specialIsoform/special_vs_conserveFPKMDomain.py -Aisoform  ../A2_PacBio.txt   -Bisoform ../TM1_PacBio.txt  -input Isoform_DomainFPKMChange/conserve_specialIsoform.txt -o Isoform_DomainFPKMChange/conserve_specialIsoformDomain.txt

```

| 类型    | 主要表达的转录本发生改变 | 主要表达的转录本没有改变 | Total |
| ------- | ------------------------ | ------------------------ | ----- |
| A基因组 | 1599                     | 3338                     | 4937  |
| D基因组 | 1375                     | 3604                     | 4979  |

**7.同一个基因组内，不同类型基因的比较**

不存在保守转录本的这些基因，表达量最低，这里把两个基因组的数据放在同一个图内，并且对不同基因组间的表达量进行一个标准化

> A2 vs At 时，保证基因的总的read数目是一致的
>
> A2基因总表达量为：886732  read数为
>
> At基因总表达量为：270235 read数为
>
> D5基因总表达量为：286558  read数为
>
> Dt基因总的表达量为：585450  read数为













