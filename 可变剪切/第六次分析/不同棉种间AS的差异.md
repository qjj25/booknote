### 不同亚基因组间转录调控的差异

#### 不同基因组间表达水平的归一化

TM-1 BAM文件中matching read

```bash
## 统计matching read的数目，差的不多不用归一化了
samtools view -c TM1_rmdup.bam 
# TM1
79728632
# A2
53231641
# D5
49082779
```

分别比较不同基因组间同源基因在AS调控转录上的差异，首先将基因分成3类：

+ 只转录出与特定转录本不存在差异的isoform
+ 转录出的转录本与参考基因组特定的转录本存在AS的差异，并且导致了编码改变和提取终止的终止密码
+ 转录出的转录本与参考基因组特定的转录本存在AS的差异，inframeChange

#### ORF长度上的差异

比例A2与At基因组，在ORF长度上的差异；与D5、Dt基因组ORF长度上的差异进行成对检验；

ORF长度上的差异的计算公式

> 每个ORF之间求得一个距离绝对值，然后在取平均值

#### 根据ORF的差异程度将同源基因分成3类

+ A2与At的差异与D5与Dt的差异，没有区别
+ A基因组的差异更大
+ D基因组的差异更大

```bash
##获取同源基因间cDNA长度的信息
python homologAS2.py  -homolog A2_D5_At_Dt_collinearity.txt  -A2AS A2_AS.txt  -D5AS D5_AS.txt  -A2FPKM A2_gene_FPKM.txt  -D5FPKM D5_gene_FPKM.txt  -TM1AS TM1_AS.txt  -TM1FPKM TM1_gene_FPKM.txt  -o 11
```

根据cDNA的长度来判断同源基因是否转录出了相同的转录本

通过比较含有相同转录本的数目占所有转录本的比例；反映了基因同源性的强弱；

### 二倍体和四倍体在AS上的差异

首先对基因进行筛选：

+ FPKM值大于1
+ PacBio转录本数目大于等于1

针对筛选了的基因可以统计：

+ 多少基因在AS上存在差异，比较转录本间的差异
+ 多少基因同时没有AS的存在

```bash
##比较两个基因组上的差异
python differentialAS.py  -homolog A2_vs_At/A2_vs_At_collinearity.txt  -AS1 A2_AS.txt  -AS2 TM1_AS.txt  -FPKM1 A2_gene_FPKM.txt  -FPKM2 TM1_gene_FPKM.txt  -ORF1 A2_ORF.txt  -ORF2 TM1_ORF.txt  -o A2_vs_At/11
## 两个同源基因都不存在AS，统计转录本的数目
awk '$2==0&&$7==0{a+=$4;b+=$5;c+=$9}END{print a"\t"b"\t"c}' A2_vs_At/11
##两个同源基因存在AS
awk '$2!=0&&$7!=0||($2!=0&&$7==0)||($2==0&&$7!=0){a+=$4;b+=$5;c+=$9}END{print a"\t"b"\t"c}' A2_vs_At/11
```

统计表达了的基因；通过统计发现

A2_vs_At, D5_vs_Dt这些分别有4034/11292(35.72%)、3649/11690(31.21%)、4205/12772(32.92%) 、3359/9651(34.8%)



| 比较     | 表达的基因数 | 不存在AS基因 | 存在AS差异的基因 | 保守的isoform数 | isform1    | isoform2   |
| -------- | ------------ | ------------ | ---------------- | --------------- | ---------- | ---------- |
| A2_vs_At | 11292        | 4034         | 7258             | 2634/5603       | 3557/18741 | 2534/12087 |
| D5_vs_Dt | 11690        | 3649         | 8041             | 2501/6058       | 2698/15739 | 2181/12973 |
| A2_vs_D5 | 12772        | 4205         | 8567             | 2867/6853       | 3368/19773 | 2843/15164 |
| At_vs_Dt | 9651         | 3359         | 6292             | 2914/2752       | 1521/13217 | 2882/13173 |

发现不存在AS的基因，与存在AS的基因在特异性转录本的数目上存在差异，进行卡方测验

| A2At否发生AS | 保守的isoform数 | 不保守的isoform数 |
| ------------ | --------------- | ----------------- |
| 不发生AS     | 2634            | 6091              |
| 发生AS       | 5603            | 30828             |


| D5Dt否发生AS | 保守的isoform数 | 不保守的isoform数 |
| ------------ | --------------- | ----------------- |
| 不发生AS     | 2501            | 4879              |
| 发生AS       | 6058            | 28712             |

| A2D5否发生AS | 保守的isoform数 | 不保守的isoform数 |
| ------------ | --------------- | ----------------- |
| 不发生AS     | 2867            | 6211              |
| 发生AS       | 6853            | 34937             |

| AtAt否发生AS | 保守的isoform数 | 不保守的isoform数 |
| ------------ | --------------- | ----------------- |
| 不发生AS     | 2914            | 6091              |
| 发生AS       | 2752            | 26390             |

AS造成同源基因特异性isoform的增加

> 在证明了发生AS的基因中亚基因组特异性的转录本数目更多，进一步证明特异性转录本随着AS事件的增加，这些转录本也会随之增加。首先将基因的AS划分区段，比较每个区段中特异性转录本数目的变化。

```bash
for i in 1
do
## 比较AS为0的两个基因组中特异性转录本的平均水平
awk '$2==0{print $0}' 11|awk '{print $4}' >A_0AS
awk '$7==0{print $0}' 11|awk '{print $9}' >B_0AS
## 1~5个剪切事件时对应的特异性isoform数目
awk '$2>0&&$2<=5{print $0}' 11|awk '{print $4}' >A_5AS
awk '$7>0&&$7<=5{print $0}' 11|awk '{print $9}' >B_5AS
## 5~10个剪切事件对应的特异性isoform数目
awk '$2>5&&$2<=10{print $0}' 11|awk '{print $4}' >A_10AS
awk '$7>5&&$7<=10{print $0}' 11|awk '{print $9}' >B_10AS
## 10~15个剪切事件对应的特异性isoform数目
awk '$2>10&&$2<=15{print $0}' 11|awk '{print $4}' >A_15AS
awk '$7>10&&$7<=15{print $0}' 11|awk '{print $9}' >B_15AS
## 15~20个剪切事件对应的特异性isoform数目
awk '$2>15{print $0}' 11|awk '{print $4}' >A_20AS
awk '$7>15{print $0}' 11|awk '{print $9}' >B_20AS
done
```



分析所有表达的基因中，有多少同源基因存在保守的isoform

```bash
##统计保守基因的比例
awk '$5!=0{a+=1}END{print a/NR}' A2_vs_At/11
```

通过比较发现A2与D5中存在60%多的基因存在共有的isoform；而At与Dt中仅仅只有30%；

| 比较     | 所有基因 | 存在AS   | 不存在AS |
| -------- | -------- | -------- | -------- |
| A2_vs_At | 0.588204 | 0.570681 | 0.619732 |
| D5_vs_Dt | 0.606159 | 0.585748 | 0.651137 |
| A2_vs_D5 | 0.640385 | 0.635929 | 0.649465 |
| At_vs_Dt | 0.384105 | 0.355213 | 0.438226 |

#### 总结

> 在不同棉种中鉴定完可变剪切和直系同源基因的数据后，接下来就是分析不同棉种中同源基因的AS差异。
>
> 首先根据基因表达量和PacBio检测到转录本的数目，找出expressed的基因；根据基因是否鉴定到AS分为存在AS的同源基因对和不存在AS的同源基因对；在不同同源基因的比较中大约有31%~35%的同源基因存在AS。通过比较同源基因转录本CDS序列的长度来判断转录本是否相同；分析存在相同转录本的基因所占的比例发现A2和D5同源基因具有相同功能转录本的基因比例最高；而At、Dt中的比例是最低的仅仅只有38%。A、D两个亚基因组存在于单个个体时表现出最高比例；而在多倍化后A、D亚组间具有保守转录本的基因比例迅速下降，并且存在很多At、Dt亚基因组同源基因不存在保守的AS。这部分不保守的同源基因可能由于AS的作用产生的，而具体的调控方式则可能通过改变编码框诱导NMD机制，或者改变一大段的氨基酸序列形成新的功能
>
> 接下来从两个进化角度进行分析：
>
> 1. 四倍体内具有**保守转录本**的基因可能是一些加性效应的基因
>    1. 在二倍体内某一个亚基因组不存在对应的转录本，同时在四倍体内出现了保守的转录本；可能是由于二倍体内那个基因组的表达受到AS的抑制，在四倍体内解除了
>    2. 在二倍体内都不存在，四倍体内检测到了
> 2. 四倍体内不具有保守转录本的基因，可能功能发生了分化、或者由于AS导致其中一个基因的转录本降解没有检测到
>    1. 二倍体内也不保守，分别各自与对应的亚基因组保守
>    2. 二倍体内保守，多倍化后一个亚基因组由于AS丧失了
>    3. 二倍体内不存在，多倍化后某一个亚组由于特异的AS产生的







